{"ast":null,"code":"import _extends from '@babel/runtime/helpers/esm/extends';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport React, { useContext, useState, useEffect, useRef } from 'react';\nimport { defaultElement, frameLoop } from 'shared/globals';\nimport { Controller, config } from '@react-spring/core';\nimport { withAnimated } from '@react-spring/animated';\nimport { useMemoOne } from 'use-memo-one';\nimport { useOnce } from 'shared';\nconst AnimatedView = withAnimated(defaultElement);\nconst ParentContext = React.createContext(null);\n\nfunction getScrollType(horizontal) {\n  return horizontal ? 'scrollLeft' : 'scrollTop';\n}\n\nconst START_TRANSLATE_3D = 'translate3d(0px,0px,0px)';\nconst START_TRANSLATE = 'translate(0px,0px)';\nconst ParallaxLayer = React.memo(_ref => {\n  let {\n    horizontal,\n    factor = 1,\n    offset = 0,\n    speed = 0\n  } = _ref,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"horizontal\", \"factor\", \"offset\", \"speed\"]); // Our parent controls our height and position.\n\n\n  const parent = useContext(ParentContext); // This is how we animate.\n\n  const ctrl = useMemoOne(() => {\n    const targetScroll = Math.floor(offset) * parent.space;\n    const distance = parent.space * offset + targetScroll * speed;\n    return new Controller({\n      space: parent.space * factor,\n      translate: -(parent.current * speed) + distance\n    });\n  }, []); // Create the layer.\n\n  const layer = useMemoOne(() => ({\n    setPosition(height, scrollTop, immediate = false) {\n      const targetScroll = Math.floor(offset) * height;\n      const distance = height * offset + targetScroll * speed;\n      ctrl.start({\n        translate: -(scrollTop * speed) + distance,\n        config: parent.config,\n        immediate\n      });\n    },\n\n    setHeight(height, immediate = false) {\n      ctrl.start({\n        space: height * factor,\n        config: parent.config,\n        immediate\n      });\n    }\n\n  }), []); // Register the layer with our parent.\n\n  useOnce(() => {\n    if (parent) {\n      parent.layers.add(layer);\n      parent.update();\n      return () => {\n        parent.layers.delete(layer);\n        parent.update();\n      };\n    }\n  });\n  const translate3d = ctrl.get('translate').to(horizontal ? x => `translate3d(${x}px,0,0)` : y => `translate3d(0,${y}px,0)`);\n  return React.createElement(AnimatedView, Object.assign({}, rest, {\n    style: _extends({\n      position: 'absolute',\n      backgroundSize: 'auto',\n      backgroundRepeat: 'no-repeat',\n      willChange: 'transform',\n      [horizontal ? 'height' : 'width']: '100%',\n      [horizontal ? 'width' : 'height']: ctrl.get('space'),\n      WebkitTransform: translate3d,\n      MsTransform: translate3d,\n      transform: translate3d\n    }, rest.style)\n  }));\n  return null;\n});\nconst Parallax = React.memo(_ref2 => {\n  let {\n    pages,\n    config: config$1 = config.slow,\n    enabled = true,\n    horizontal = false\n  } = _ref2,\n      rest = _objectWithoutPropertiesLoose(_ref2, [\"pages\", \"config\", \"enabled\", \"horizontal\", \"innerStyle\"]);\n\n  const [ready, setReady] = useState(false);\n  let state;\n  state = useMemoOne(() => ({\n    config: config$1,\n    busy: false,\n    space: 0,\n    current: 0,\n    offset: 0,\n    controller: new Controller({\n      scroll: 0\n    }),\n    layers: new Set(),\n    update: () => _update(),\n    scrollTo: offset => _scrollTo(offset),\n    stop: () => state.controller.stop()\n  }), []);\n  useEffect(() => {\n    state.config = config$1;\n  }, [config$1]);\n  const containerRef = useRef();\n  const contentRef = useRef();\n\n  const _update = () => {\n    const container = containerRef.current;\n    if (!container) return;\n    const spaceProp = horizontal ? 'clientWidth' : 'clientHeight';\n    state.space = container[spaceProp];\n    const scrollType = getScrollType(horizontal);\n\n    if (enabled) {\n      state.current = container[scrollType];\n    } else {\n      container[scrollType] = state.current = state.offset * state.space;\n    }\n\n    const content = contentRef.current;\n\n    if (content) {\n      const sizeProp = horizontal ? 'width' : 'height';\n      content.style[sizeProp] = `${state.space * pages}px`;\n    }\n\n    state.layers.forEach(layer => {\n      layer.setHeight(state.space, true);\n      layer.setPosition(state.space, state.current, true);\n    });\n  };\n\n  const _scrollTo = offset => {\n    const container = containerRef.current;\n    const scrollType = getScrollType(horizontal);\n    state.offset = offset;\n    state.controller.stop().start({\n      scroll: offset * state.space,\n      config: config$1,\n\n      onFrame({\n        scroll\n      }) {\n        container[scrollType] = scroll;\n      }\n\n    });\n  };\n\n  const onScroll = event => {\n    if (!state.busy) {\n      state.busy = true;\n      state.current = event.target[getScrollType(horizontal)];\n      frameLoop.onFrame(() => {\n        state.layers.forEach(layer => layer.setPosition(state.space, state.current));\n        state.busy = false;\n      });\n    }\n  };\n\n  useEffect(() => state.update());\n  useOnce(() => {\n    setReady(true);\n\n    const onResize = () => {\n      const update = () => state.update();\n\n      frameLoop.onFrame(update);\n      setTimeout(update, 150); // Some browsers don't fire on maximize!\n    };\n\n    window.addEventListener('resize', onResize, false);\n    return () => window.removeEventListener('resize', onResize, false);\n  });\n  const overflow = enabled ? 'scroll' : 'hidden';\n  return React.createElement(defaultElement, Object.assign({}, rest, {\n    ref: containerRef,\n    onScroll: onScroll,\n    onWheel: enabled ? state.stop : null,\n    onTouchStart: enabled ? state.stop : null,\n    style: _extends({\n      position: 'absolute',\n      width: '100%',\n      height: '100%',\n      overflow,\n      overflowY: horizontal ? 'hidden' : overflow,\n      overflowX: horizontal ? overflow : 'hidden',\n      WebkitOverflowScrolling: 'touch',\n      WebkitTransform: START_TRANSLATE,\n      MsTransform: START_TRANSLATE,\n      transform: START_TRANSLATE_3D\n    }, rest.style)\n  }), ready && React.createElement(defaultElement, {\n    ref: contentRef,\n    style: _extends({\n      overflow: 'hidden',\n      position: 'absolute',\n      [horizontal ? 'height' : 'width']: '100%',\n      [horizontal ? 'width' : 'height']: state.space * pages,\n      WebkitTransform: START_TRANSLATE,\n      MsTransform: START_TRANSLATE,\n      transform: START_TRANSLATE_3D\n    }, innerStyle)\n  }, React.createElement(ParentContext.Provider, {\n    value: state\n  }, rest.children)));\n});\nexport { Parallax, ParallaxLayer };","map":{"version":3,"sources":["src/parallax.tsx"],"names":["AnimatedView","withAnimated","ParentContext","React","horizontal","START_TRANSLATE_3D","START_TRANSLATE","ParallaxLayer","factor","offset","speed","rest","parent","useContext","ctrl","useMemoOne","targetScroll","Math","distance","space","translate","layer","setPosition","immediate","height","scrollTop","config","setHeight","useOnce","translate3d","x","y","style","position","backgroundSize","backgroundRepeat","willChange","WebkitTransform","MsTransform","transform","Parallax","configs","enabled","useState","state","busy","current","controller","scroll","layers","update","scrollTo","stop","useEffect","containerRef","useRef","contentRef","container","spaceProp","scrollType","getScrollType","content","sizeProp","pages","onFrame","onScroll","event","frameLoop","setReady","onResize","setTimeout","window","overflow","ref","onWheel","onTouchStart","width","overflowY","overflowX","WebkitOverflowScrolling","ready","value"],"mappings":"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","sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport React, { useContext, useState, useEffect, useRef } from 'react';\nimport { defaultElement, frameLoop } from 'shared/globals';\nimport { Controller, config } from '@react-spring/core';\nimport { withAnimated } from '@react-spring/animated';\nimport { useMemoOne } from 'use-memo-one';\nimport { useOnce } from 'shared';\n\nconst AnimatedView = withAnimated(defaultElement);\nconst ParentContext = React.createContext(null);\n\nfunction getScrollType(horizontal) {\n  return horizontal ? 'scrollLeft' : 'scrollTop';\n}\n\nconst START_TRANSLATE_3D = 'translate3d(0px,0px,0px)';\nconst START_TRANSLATE = 'translate(0px,0px)';\nconst ParallaxLayer = React.memo((_ref) => {\n  let {\n    horizontal,\n    factor = 1,\n    offset = 0,\n    speed = 0\n  } = _ref,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"horizontal\", \"factor\", \"offset\", \"speed\"]);\n\n  // Our parent controls our height and position.\n  const parent = useContext(ParentContext); // This is how we animate.\n\n  const ctrl = useMemoOne(() => {\n    const targetScroll = Math.floor(offset) * parent.space;\n    const distance = parent.space * offset + targetScroll * speed;\n    return new Controller({\n      space: parent.space * factor,\n      translate: -(parent.current * speed) + distance\n    });\n  }, []); // Create the layer.\n\n  const layer = useMemoOne(() => ({\n    setPosition(height, scrollTop, immediate = false) {\n      const targetScroll = Math.floor(offset) * height;\n      const distance = height * offset + targetScroll * speed;\n      ctrl.start({\n        translate: -(scrollTop * speed) + distance,\n        config: parent.config,\n        immediate\n      });\n    },\n\n    setHeight(height, immediate = false) {\n      ctrl.start({\n        space: height * factor,\n        config: parent.config,\n        immediate\n      });\n    }\n\n  }), []); // Register the layer with our parent.\n\n  useOnce(() => {\n    if (parent) {\n      parent.layers.add(layer);\n      parent.update();\n      return () => {\n        parent.layers.delete(layer);\n        parent.update();\n      };\n    }\n  });\n  const translate3d = ctrl.get('translate').to(horizontal ? x => `translate3d(${x}px,0,0)` : y => `translate3d(0,${y}px,0)`);\n  return React.createElement(AnimatedView, Object.assign({}, rest, {\n    style: _extends({\n      position: 'absolute',\n      backgroundSize: 'auto',\n      backgroundRepeat: 'no-repeat',\n      willChange: 'transform',\n      [horizontal ? 'height' : 'width']: '100%',\n      [horizontal ? 'width' : 'height']: ctrl.get('space'),\n      WebkitTransform: translate3d,\n      MsTransform: translate3d,\n      transform: translate3d\n    }, rest.style)\n  }));\n  return null;\n});\nconst Parallax = React.memo((_ref2) => {\n  let {\n    pages,\n    config: config$1 = config.slow,\n    enabled = true,\n    horizontal = false\n  } = _ref2,\n      rest = _objectWithoutPropertiesLoose(_ref2, [\"pages\", \"config\", \"enabled\", \"horizontal\", \"innerStyle\"]);\n\n  const [ready, setReady] = useState(false);\n  let state;\n  state = useMemoOne(() => ({\n    config: config$1,\n    busy: false,\n    space: 0,\n    current: 0,\n    offset: 0,\n    controller: new Controller({\n      scroll: 0\n    }),\n    layers: new Set(),\n    update: () => _update(),\n    scrollTo: offset => _scrollTo(offset),\n    stop: () => state.controller.stop()\n  }), []);\n  useEffect(() => {\n    state.config = config$1;\n  }, [config$1]);\n  const containerRef = useRef();\n  const contentRef = useRef();\n\n  const _update = () => {\n    const container = containerRef.current;\n    if (!container) return;\n    const spaceProp = horizontal ? 'clientWidth' : 'clientHeight';\n    state.space = container[spaceProp];\n    const scrollType = getScrollType(horizontal);\n\n    if (enabled) {\n      state.current = container[scrollType];\n    } else {\n      container[scrollType] = state.current = state.offset * state.space;\n    }\n\n    const content = contentRef.current;\n\n    if (content) {\n      const sizeProp = horizontal ? 'width' : 'height';\n      content.style[sizeProp] = `${state.space * pages}px`;\n    }\n\n    state.layers.forEach(layer => {\n      layer.setHeight(state.space, true);\n      layer.setPosition(state.space, state.current, true);\n    });\n  };\n\n  const _scrollTo = offset => {\n    const container = containerRef.current;\n    const scrollType = getScrollType(horizontal);\n    state.offset = offset;\n    state.controller.stop().start({\n      scroll: offset * state.space,\n      config: config$1,\n\n      onFrame({\n        scroll\n      }) {\n        container[scrollType] = scroll;\n      }\n\n    });\n  };\n\n  const onScroll = event => {\n    if (!state.busy) {\n      state.busy = true;\n      state.current = event.target[getScrollType(horizontal)];\n      frameLoop.onFrame(() => {\n        state.layers.forEach(layer => layer.setPosition(state.space, state.current));\n        state.busy = false;\n      });\n    }\n  };\n\n  useEffect(() => state.update());\n  useOnce(() => {\n    setReady(true);\n\n    const onResize = () => {\n      const update = () => state.update();\n\n      frameLoop.onFrame(update);\n      setTimeout(update, 150); // Some browsers don't fire on maximize!\n    };\n\n    window.addEventListener('resize', onResize, false);\n    return () => window.removeEventListener('resize', onResize, false);\n  });\n  const overflow = enabled ? 'scroll' : 'hidden';\n  return React.createElement(defaultElement, Object.assign({}, rest, {\n    ref: containerRef,\n    onScroll: onScroll,\n    onWheel: enabled ? state.stop : null,\n    onTouchStart: enabled ? state.stop : null,\n    style: _extends({\n      position: 'absolute',\n      width: '100%',\n      height: '100%',\n      overflow,\n      overflowY: horizontal ? 'hidden' : overflow,\n      overflowX: horizontal ? overflow : 'hidden',\n      WebkitOverflowScrolling: 'touch',\n      WebkitTransform: START_TRANSLATE,\n      MsTransform: START_TRANSLATE,\n      transform: START_TRANSLATE_3D\n    }, rest.style)\n  }), ready && React.createElement(defaultElement, {\n    ref: contentRef,\n    style: _extends({\n      overflow: 'hidden',\n      position: 'absolute',\n      [horizontal ? 'height' : 'width']: '100%',\n      [horizontal ? 'width' : 'height']: state.space * pages,\n      WebkitTransform: START_TRANSLATE,\n      MsTransform: START_TRANSLATE,\n      transform: START_TRANSLATE_3D\n    }, innerStyle)\n  }, React.createElement(ParentContext.Provider, {\n    value: state\n  }, rest.children)));\n});\n\nexport { Parallax, ParallaxLayer };\n//# sourceMappingURL=index.js.map\n"]},"metadata":{},"sourceType":"module"}